!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){"use strict";var r=n(2);(new(function(e){return e&&e.__esModule?e:{default:e}}(r).default)).init()},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(3),o=r(a),l=n(4),c=r(l),f=function(){function e(){u(this,e),this.form=document.signup,this.listContainer=document.querySelector(e.USER_LIST_CONTAINER_SELECTOR),this.log=new c.default,this.form&&this.listContainer&&(this.submit=this.form.querySelector(e.SUBMIT_ELEMENT_SELECTOR),this.msg=this.form.querySelector(e.MESSAGE_ELEMENT_SELECTOR))}return s(e,null,[{key:"USER_LIST_CONTAINER_SELECTOR",get:function(){return".js-user-list"}},{key:"FORM_ELEMENT_SELECTOR",get:function(){return".js-form-el"}},{key:"SUBMIT_ELEMENT_SELECTOR",get:function(){return".js-submit"}},{key:"MESSAGE_ELEMENT_SELECTOR",get:function(){return".js-msg"}},{key:"COUNTRY_API_URL",get:function(){return"https://restcountries.eu/rest/v2/all"}},{key:"MESSAGE_HIDDEN_CLASS",get:function(){return"msg--hidden"}},{key:"MONTH_NAMES",get:function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}}]),s(e,[{key:"init",value:function(){if(!this.form||!this.listContainer)throw new Error("Some of the elements needed are not present in the document.");this.initForm(),this.bindEvents(),this.createList()}},{key:"initForm",value:function(){var t=this;this.form.querySelectorAll(e.FORM_ELEMENT_SELECTOR).forEach(function(e){var n=new o.default(e);"countryList"===e.getAttribute("data-type")&&t.fetchCountries(n)})}},{key:"fetchCountries",value:function(t){var n=this;t&&fetch(e.COUNTRY_API_URL).then(function(e){return e.json()}).then(function(e){var r=e.map(function(e){var t={};return t.name=e.name,t});t.selectList=r,n.submitState(!1)}).catch(function(){t.error("Sorry, we got an error trying to get the country list")})}},{key:"submitState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.submit&&(this.submit.disabled=e)}},{key:"bindEvents",value:function(){this.form.addEventListener("submit",this.onSubmit.bind(this))}},{key:"onSubmit",value:function(e){var t=this.getFormData();this.displayMessage(t),this.addLog(t),this.log.userList=t,this.form.reset(),e.preventDefault()}},{key:"getFormData",value:function(){var e=this.form.elements;return{name:e.name.value,lastname:e.surname.value,country:e.country.value,birthdayString:e.birthday.value}}},{key:"displayMessage",value:function(t){if(this.msg&&t){var n=this.stringToDate(t.birthdayString),r=this.nextBirthdayAge(n);this.msg.classList.remove(e.MESSAGE_HIDDEN_CLASS),this.msg.innerHTML="Hello "+t.name+" "+t.lastname+" from "+t.country+".",this.msg.innerHTML+=" on "+n.getDate()+" of "+e.MONTH_NAMES[n.getMonth()],this.msg.innerHTML+=" you will have "+r+" years old."}}},{key:"stringToDate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"01/01/1970",t=e.split("/").reverse().map(function(e,t){return 1===t?parseFloat(e)-1:parseFloat(e)});return new(Function.prototype.bind.apply(Date,[null].concat(i(t))))}},{key:"nextBirthdayAge",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(Date.now()-e.getTime());return Math.abs(t.getUTCFullYear()-1970)+1}},{key:"addLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=document.createElement("div");t.innerHTML='<div class="user-list__entry"><span class="user-list__cel user-list__cel--main">'+e.name+" "+e.lastname+'</span><span class="user-list__cel">'+e.country+'</span><span class="user-list__cel">'+e.birthdayString+"</span></div>",this.listContainer.insertBefore(t.firstChild,this.listContainer.firstChild).addEventListener("click",this.displayMessage.bind(this,e))}},{key:"createList",value:function(){var e=this;this.log.userList.forEach(function(t){e.addLog(t)})}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input, textarea, select";r(this,e),this._containerElement=t,this._inputElement=this._containerElement.querySelector(n),this.bindEvents()}return i(e,null,[{key:"ERROR_ITEM_STYLE",get:function(){return"ca-form__error-item"}},{key:"FORM_GROUP_ERROR_CLASS",get:function(){return"form-el--error"}},{key:"INPUT_ERROR_SELECTOR",get:function(){return".js-input-error"}}]),i(e,[{key:"error",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this._containerElement.classList.add(e.FORM_GROUP_ERROR_CLASS);var n=this._containerElement.querySelector(e.INPUT_ERROR_SELECTOR);n&&(n.innerHTML=t)}},{key:"bindEvents",value:function(){this._inputElement&&(this._inputElement.addEventListener("blur",this.blurEventHandler.bind(this)),this._inputElement.addEventListener("keyup",this.keyUpEventHandler.bind(this)))}},{key:"blurEventHandler",value:function(){this.validate()?(this.error(),this._containerElement.classList.remove(e.FORM_GROUP_ERROR_CLASS)):this.error(this._inputElement.validationMessage)}},{key:"keyUpEventHandler",value:function(){this._containerElement.classList.contains(e.FORM_GROUP_ERROR_CLASS)&&this.blurEventHandler()}},{key:"validate",value:function(){return!((this._inputElement.required||this._inputElement.getAttribute("pattern"))&&!this._inputElement.checkValidity())||(this._containerElement.classList.add(e.FORM_GROUP_ERROR_CLASS),!1)}},{key:"disable",value:function(){this._inputElement.disabled=!0,this.unbindEvents()}},{key:"enable",value:function(){this._inputElement.disabled=!1,this.bindEvents()}},{key:"data",set:function(e){this._inputElement.value=e},get:function(){return this._inputElement.value}},{key:"selectList",set:function(e){var t=this;"SELECT"===this._inputElement.tagName&&(this._inputElement.innerHTML="",e.forEach(function(e){if(e.name){var n=document.createElement("option");t._inputElement.appendChild(n),n.innerHTML=e.name,n.setAttribute("value",e.val||e.name)}}))}},{key:"required",set:function(e){this._inputElement.required=e},get:function(){return this._inputElement.required}},{key:"element",get:function(){return this._containerElement}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(){r(this,e)}return i(e,[{key:"userList",set:function(t){var n=this.userList;n.push(t),localStorage.setItem(e.LOCALSTORAGE_VARIABLE,JSON.stringify(n))},get:function(){return JSON.parse(localStorage.getItem(e.LOCALSTORAGE_VARIABLE))||[]}}],[{key:"LOCALSTORAGE_VARIABLE",get:function(){return"userList"}}]),e}();t.default=u},function(e,t,n){n(0),e.exports=n(1)}]);
//# sourceMappingURL=main.js.map